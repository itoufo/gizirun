<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>プロジェクトレビュー ダッシュボード - Notta</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.7; }
    .header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: #fff; padding: 2.5rem 2rem; text-align: center; }
    .header h1 { font-size: 1.75rem; font-weight: 700; }
    .header .meta { font-size: 0.875rem; color: #94a3b8; margin-top: 0.5rem; }
    .container { max-width: 1060px; margin: 0 auto; padding: 2rem 1.5rem; }
    .overall-section { text-align: center; margin-bottom: 3rem; }
    .overall-badge { width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: 800; color: #fff; margin: 0 auto 1rem; box-shadow: 0 8px 24px rgba(0,0,0,0.15); }
    .grade-A { background: linear-gradient(135deg, #22c55e, #16a34a); }
    .grade-B { background: linear-gradient(135deg, #3b82f6, #2563eb); }
    .grade-C { background: linear-gradient(135deg, #eab308, #ca8a04); }
    .grade-D { background: linear-gradient(135deg, #f97316, #ea580c); }
    .grade-F { background: linear-gradient(135deg, #ef4444, #dc2626); }
    .overall-section h2 { font-size: 1.25rem; margin-bottom: 0.5rem; }
    .overall-section p { color: #64748b; max-width: 600px; margin: 0 auto; }
    .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 3rem; }
    .axis-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 12px; padding: 1.75rem; text-decoration: none; color: inherit; display: block; transition: box-shadow 0.2s, transform 0.2s; }
    .axis-card:hover { box-shadow: 0 8px 24px rgba(0,0,0,0.1); transform: translateY(-2px); }
    .card-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
    .card-badge { width: 52px; height: 52px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.375rem; font-weight: 800; color: #fff; flex-shrink: 0; }
    .card-header h3 { font-size: 1.0625rem; font-weight: 700; }
    .card-summary { color: #64748b; font-size: 0.875rem; margin-bottom: 1rem; }
    .card-stats { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .card-stat { font-size: 0.75rem; padding: 0.125rem 0.5rem; border-radius: 9999px; font-weight: 600; }
    .card-stat-critical { background: #fef2f2; color: #dc2626; }
    .card-stat-high { background: #fff7ed; color: #ea580c; }
    .card-stat-medium { background: #fefce8; color: #ca8a04; }
    .card-stat-low { background: #f0fdf4; color: #65a30d; }
    .section-title { font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e2e8f0; }
    .priority-list { margin-bottom: 2rem; }
    .priority-item { background: #fff; border: 1px solid #e2e8f0; border-radius: 10px; padding: 1rem 1.5rem; margin-bottom: 0.75rem; display: flex; gap: 1rem; align-items: flex-start; }
    .priority-number { width: 28px; height: 28px; background: #ef4444; color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.8rem; flex-shrink: 0; }
    .priority-content { flex: 1; }
    .priority-content strong { font-size: 0.9375rem; }
    .priority-content p { color: #64748b; font-size: 0.8125rem; margin: 0.25rem 0 0; }
    .priority-meta { font-size: 0.75rem; color: #94a3b8; }
    .footer { text-align: center; color: #94a3b8; font-size: 0.75rem; padding: 2rem 0; border-top: 1px solid #e2e8f0; margin-top: 2rem; }
  </style>
</head>
<body>
  <div class="header">
    <h1>プロジェクトレビュー ダッシュボード</h1>
    <div class="meta">Notta | 2026-01-29</div>
  </div>
  <div class="container">
    <div class="overall-section">
      <div class="overall-badge grade-C">C</div>
      <h2>総合評価</h2>
      <p>Next.js App Routerの規約に沿った構成で、Supabase Auth・Prisma・Zodによる基盤は堅実。しかし、テスト完全欠如・エラートラッキング未導入・レート制限未実装・一部の認可チェック漏れが総合グレードを押し下げている。インメモリ状態管理のサーバーレス非対応も早期解決が必要。</p>
    </div>

    <div class="dashboard-grid">
      <a href="architecture.html" class="axis-card">
        <div class="card-header">
          <div class="card-badge grade-B">B</div>
          <h3>アーキテクチャレビュー</h3>
        </div>
        <p class="card-summary">App Router規約準拠の構成。インメモリ状態管理のサーバーレス非対応と一部巨大APIルートが課題。</p>
        <div class="card-stats">
          <span class="card-stat card-stat-critical">Critical: 0</span>
          <span class="card-stat card-stat-high">High: 4</span>
          <span class="card-stat card-stat-medium">Medium: 5</span>
          <span class="card-stat card-stat-low">Low: 3</span>
        </div>
      </a>

      <a href="security.html" class="axis-card">
        <div class="card-header">
          <div class="card-badge grade-C">C</div>
          <h3>セキュリティレビュー</h3>
        </div>
        <p class="card-summary">認証はSupabase Auth完備。認可チェック漏れ・バリデーション欠落・レート制限未実装が課題。</p>
        <div class="card-stats">
          <span class="card-stat card-stat-critical">Critical: 1</span>
          <span class="card-stat card-stat-high">High: 4</span>
          <span class="card-stat card-stat-medium">Medium: 4</span>
          <span class="card-stat card-stat-low">Low: 2</span>
        </div>
      </a>

      <a href="performance.html" class="axis-card">
        <div class="card-header">
          <div class="card-badge grade-C">C</div>
          <h3>パフォーマンスレビュー</h3>
        </div>
        <p class="card-summary">React Queryキャッシュは適切。ページネーション未実装・過剰データ取得・DBインデックス不足が課題。</p>
        <div class="card-stats">
          <span class="card-stat card-stat-critical">Critical: 0</span>
          <span class="card-stat card-stat-high">High: 3</span>
          <span class="card-stat card-stat-medium">Medium: 5</span>
          <span class="card-stat card-stat-low">Low: 3</span>
        </div>
      </a>

      <a href="quality.html" class="axis-card">
        <div class="card-header">
          <div class="card-badge grade-B">B</div>
          <h3>コード品質レビュー</h3>
        </div>
        <p class="card-summary">TypeScript strict有効、Zodバリデーション導入済。unsafe cast多用とAPIルート間の重複が課題。</p>
        <div class="card-stats">
          <span class="card-stat card-stat-critical">Critical: 0</span>
          <span class="card-stat card-stat-high">High: 2</span>
          <span class="card-stat card-stat-medium">Medium: 6</span>
          <span class="card-stat card-stat-low">Low: 4</span>
        </div>
      </a>

      <a href="testing.html" class="axis-card">
        <div class="card-header">
          <div class="card-badge grade-D">D</div>
          <h3>テスト・可観測性レビュー</h3>
        </div>
        <p class="card-summary">テスト0件、エラートラッキング未導入、構造化ログなし。可観測性基盤が全体的に欠如。</p>
        <div class="card-stats">
          <span class="card-stat card-stat-critical">Critical: 2</span>
          <span class="card-stat card-stat-high">High: 3</span>
          <span class="card-stat card-stat-medium">Medium: 3</span>
          <span class="card-stat card-stat-low">Low: 2</span>
        </div>
      </a>
    </div>

    <h2 class="section-title">優先改善事項（全軸横断）</h2>
    <div class="priority-list">
      <div class="priority-item">
        <div class="priority-number">1</div>
        <div class="priority-content">
          <strong>テストフレームワーク導入・初期テスト作成</strong>
          <p>Vitestを導入し、バリデーション・ユーティリティ・AI分析ロジックのユニットテストを作成。APIルートの統合テストも段階的に追加。</p>
        </div>
        <div class="priority-meta">テスト・可観測性 | Critical</div>
      </div>
      <div class="priority-item">
        <div class="priority-number">2</div>
        <div class="priority-content">
          <strong>recording-sessions所有権検証の追加</strong>
          <p>segments・completeエンドポイントでTranscriptのuserIdとリクエストユーザーの一致を検証。IDOR脆弱性の即時解消。</p>
        </div>
        <div class="priority-meta">セキュリティ | Critical</div>
      </div>
      <div class="priority-item">
        <div class="priority-number">3</div>
        <div class="priority-content">
          <strong>エラートラッキング・構造化ロガー導入</strong>
          <p>Sentry（@sentry/nextjs）でエラー捕捉、pinoで構造化ログ。本番環境の可観測性を確保。</p>
        </div>
        <div class="priority-meta">テスト・可観測性 | Critical + High</div>
      </div>
      <div class="priority-item">
        <div class="priority-number">4</div>
        <div class="priority-content">
          <strong>全APIレート制限・入力バリデーション統一</strong>
          <p>Upstash Ratelimitで全APIを保護。未検証エンドポイント（PUT transcripts, topic-analysis segment等）にZodスキーマを適用。</p>
        </div>
        <div class="priority-meta">セキュリティ | High</div>
      </div>
      <div class="priority-item">
        <div class="priority-number">5</div>
        <div class="priority-content">
          <strong>インメモリ状態管理のDB永続化統一</strong>
          <p>TopicOrchestrator・SessionManagerをDB永続化に移行し、サーバーレス環境での安全な動作を保証。</p>
        </div>
        <div class="priority-meta">アーキテクチャ | High</div>
      </div>
    </div>
  </div>
  <div class="footer">
    Generated by Claude Code Project Review | 2026-01-29T00:00:00Z
  </div>
</body>
</html>